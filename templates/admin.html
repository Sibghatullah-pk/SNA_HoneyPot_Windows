{% extends 'base.html' %}

{% block title %}Admin Portal - Sentinel{% endblock %}

{% block extra_head %}
<style>
/* Professional admin theme: authoritative, precise, urgent accents */
.admin-grid{display:grid;grid-template-columns:1fr 380px;gap:20px}
.card{background:linear-gradient(180deg,#0b1220 0%, #071022 100%); padding:18px;border-radius:10px;color:#dbe9ff;box-shadow:0 8px 30px rgba(2,8,23,0.6)}
.table{width:100%;border-collapse:collapse}
.table th,.table td{padding:10px;border-bottom:1px solid rgba(255,255,255,0.03);vertical-align:middle}
.controls{display:flex;gap:8px;flex-wrap:wrap}
.log-box{height:360px;overflow:auto;background:#06070a;padding:12px;border-radius:6px;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, monospace;font-size:12px;color:#bcd7ff}
.badge{display:inline-block;padding:6px 10px;border-radius:6px;font-weight:700}
.btn{background:linear-gradient(90deg,#1f8ef1,#0a74ff);color:white;padding:8px 12px;border-radius:8px;border:none;cursor:pointer;box-shadow:0 6px 14px rgba(10,116,255,0.12)}
.btn.danger{background:linear-gradient(90deg,#ff6b6b,#ff3b3b)}
.small{font-size:12px;color:#9fb8d9}

/* Header / controls layout */
.admin-top{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:14px}
.admin-filters{display:flex;gap:8px;align-items:center}
.admin-filters input[type="search"], .admin-filters select{padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#dbe9ff}

/* Table polish */
.table thead th{color:#9fc7ff;text-align:left;font-weight:800}
.table tbody tr{transition:transform .18s, background .18s;cursor:default}
.table tbody tr.new-attack{animation:flashRow 1.2s linear}
@keyframes flashRow { 0%{background:linear-gradient(90deg, rgba(34,197,94,0.06), transparent)} 100%{background:transparent} }
.table tbody tr:hover{transform:translateY(-4px);box-shadow:0 8px 24px rgba(3,7,18,0.6)}

/* Severity badges */
.badge.high{background:#ff4d6d;color:white}
.badge.medium{background:#ffb86b;color:#1b2430}
.badge.low{background:#19b394;color:white}

/* Small action buttons */
.action-btn{padding:6px 8px;border-radius:6px;border:none;background:rgba(255,255,255,0.03);color:#cfe7ff;cursor:pointer}
.action-btn.warn{background:rgba(255,90,90,0.12)}

/* Expandable detail row */
.detail-row{background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, monospace;color:#bfe0ff}
.detail-row pre{white-space:pre-wrap;margin:8px 0;padding:8px;border-radius:6px;background:rgba(255,255,255,0.02)}

/* Pager */
.pagination{display:flex;gap:6px;justify-content:flex-start;margin-top:10px}
.pagination button{padding:6px 8px;border-radius:6px;border:none;background:transparent;color:#9fb8d9}
.pagination button.active{background:#10243f;color:white}

/* Live stats aside */
.aside-stats strong{font-size:1.2rem;color:#fff}

</style>
{% endblock %}

{% block content %}
<h2>Admin Portal â€” Full Visibility</h2>
<div class="admin-grid">
    <div>
        <div class="card">
            <div class="admin-top">
                <div>
                    <h3>System Controls</h3>
                    <p class="small">Unrestricted admin view: attacks, alerts, logs, and controls.</p>
                </div>
                <div class="admin-filters">
                    <input id="searchInput" type="search" placeholder="Search IP, type, service...">
                    <select id="severityFilter"><option value="">All severities</option><option value="high">High</option><option value="medium">Medium</option><option value="low">Low</option></select>
                    <div class="controls">
                        <button id="exportJson" class="btn">Export JSON</button>
                        <button id="exportCsv" class="btn">Export CSV</button>
                        <button id="clearAll" class="btn danger">Clear All</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="card" style="margin-top:16px">
            <h3>Recent Attacks</h3>
            <table class="table">
                <thead>
                    <tr><th>Time</th><th>Source</th><th>Port</th><th>Service</th><th>Type</th><th>Action</th></tr>
                </thead>
                <tbody id="attacksBody">
                    <tr><td colspan="6" class="small">Loading...</td></tr>
                </tbody>
            </table>
            <div id="attacksPager" class="pagination" style="margin-top:8px"></div>
        </div>

        <div class="card" style="margin-top:16px">
            <h3>Alerts</h3>
            <div id="alertsList" class="small">Loading...</div>
        </div>
    </div>

    <aside>
        <div class="card">
            <h3>Live Stats</h3>
            <p>Total Attacks: <strong id="totalAttacks">0</strong></p>
            <p>Unique IPs: <strong id="uniqueIps">0</strong></p>
            <p>Port Scans: <strong id="portScans">0</strong></p>
            <p>Connections: <strong id="connections">0</strong></p>
        </div>

        <div class="card" style="margin-top:16px">
            <h3>Logs (tail)</h3>
            <div id="logBox" class="log-box">Loading logs...</div>
            <div style="margin-top:8px;display:flex;gap:8px"><input id="linesInput" type="number" value="200" style="width:90px;padding:6px;background:#0b0b0b;color:#eaeaea;border:1px solid #222;border-radius:6px"><button id="reloadLogs" class="btn">Reload</button></div>
        </div>
    </aside>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/admin.js') }}"></script>
{% endblock %}
